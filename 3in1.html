<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>EMT ìŒ€ë¨¹ í‚¤íŠ¸</title>
    <style>
        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ì„¤ì •: ê°€ë…ì„±ì„ ìœ„í•´ ì—¬ë°±ê³¼ ìƒ‰ìƒì„ ì§€ì • */
        body { font-family: sans-serif; line-height: 1.5; padding: 20px; background-color: #f4f4f4; }
        .section { background: white; padding: 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #ddd; }
        h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; margin-top: 0; }
        textarea { width: 100%; margin-top: 10px; border: 1px solid #ccc; border-radius: 4px; padding: 8px; box-sizing: border-box; }
        button { cursor: pointer; padding: 5px 10px; margin: 2px; border-radius: 4px; border: 1px solid #34495e; background: #34495e; color: white; }
        .res-box { background: #eee; padding: 10px; margin-top: 10px; border-radius: 4px; overflow-x: auto; }
        input[size="2"] { text-align: center; width: 35px; }
    </style>
</head>
<body>

<div class="section">
    <h2>ë¹„ìƒëŒ€ê¸°ì Parser</h2>
    <textarea id="parseI" rows="3" placeholder="ì¢Œìš° ë‘ê°œ ì…€ í•œë²ˆì— ë³µë¶™" oninput="parseRun()"></textarea>
    <button onclick="parseRun()">ë³€í™˜ ğŸš€</button> | 
    <button onclick="qCopy('parseO1')">ì‰¼í‘œ ë³µì‚¬</button>
    <button onclick="qCopy('parseO2')">ì •ë ¬ ë³µì‚¬</button>
    <div id="parseO1" class="res-box"></div> <div id="parseO2" class="res-box"></div> </div>

<div class="section">
    <h2>ë³‘ì‚¬íœ´ê°€ Scraper</h2>
    ê¸°ì¤€: <input type="number" id="solOF" value="5" style="width:40px">ì—´ ì „ | 
    <label><input type="checkbox" id="solSW"> ìŠ¤ìœ™</label><br>
    ì¡°íšŒ: <input id="solM" size="2">ì›” <input id="solD" size="2">ì¼ 
    <button onclick="move(-1,'sol')">âª ì´ì „</button>
    <button onclick="solRun()">ì¡°íšŒ+ë³µì‚¬ ğŸš€</button> 
    <button onclick="move(1,'sol')">ë‹¤ìŒ â©</button>
    <span id="solINF" style="color:#27ae60;font-weight:bold;margin-left:10px;"></span>
    <span id="solMSG" style="color:red;font-weight:bold;"></span>
    <textarea id="solI" rows="3" placeholder="ë”± 'íœ´ê°€ ê·¸ë¦¬ë“œ'ë§Œ ë³µë¶™" oninput="solRun()"></textarea>
    <div id="solO" class="res-box"></div>
</div>

<div class="section">
    <h2>ê°„ë¶€íœ´ê°€ Scraper</h2>
    ì¡°íšŒ: <input id="offM" size="2">ì›” <input id="offD" size="2">ì¼ <label><input type="checkbox" id="offSW"> ìŠ¤ìœ™</label>
    <button onclick="move(-1,'off')">âª ì´ì „</button>
    <button onclick="offRun()">ì¡°íšŒ+ë³µì‚¬ ğŸš€</button> 
    <button onclick="move(1,'off')">ë‹¤ìŒ â©</button>
    <span id="offINF" style="color:#27ae60;font-weight:bold;margin-left:10px;"></span>
    <textarea id="offI" rows="6" placeholder="ë‚ ì§œ í—¤ë” í¬í•¨ íŒ€ë³„ ë°ì´í„° ë³µë¶™" oninput="offRun()"></textarea>
    <div id="offO" class="res-box"></div>
</div>

<script>
/** * [ê³µí†µ ì„¤ì • ë³€ìˆ˜]
 * AM/AD: ê·¼ë¬´ ì£¼ê¸°ì˜ ê¸°ì¤€ì  (2026ë…„ 2ì›” 17ì¼ ë¯¸ë“œ ê·¼ë¬´ë¥¼ 0ìœ¼ë¡œ ì¡ìŒ)
 * VM: ì—‘ì…€ ë‹¨ì–´ë¥¼ ì¶œë ¥ìš© ì •ì‹ ëª…ì¹­ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë§¤í•‘ í…Œì´ë¸”
 */
const $=id=>document.getElementById(id), AM=2, AD=17, Y=2026;
const VM={"í¬ìƒ":"í¬ìƒíœ´ê°€","ë³´ìƒ":"ë³´ìƒíœ´ê°€","ìœ„ë¡œ":"ìœ„ë¡œíœ´ê°€","í¬íœ´":"í¬ìƒíœ´ê°€","ì—°ê°€":"ì—°ê°€","ê³µê°€":"ê³µê°€","ì™¸ë°•":"ì™¸ë°•"};

// íœ´ê°€ ê¸°ê°„ í…ìŠ¤íŠ¸ ìƒì„±: ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì´ ê°™ìœ¼ë©´ ë‹¨ì¼ì¼ìë¡œ, ë‹¤ë¥´ë©´ ë²”ìœ„ë¡œ í‘œì‹œ
const fmtDt=(m,d1,d2)=>d1==d2?`(${m}.${d1}.)`:`(${m}.${d1}.~${d2}.)`;

/**
 * [ê³µí†µ ë³µì‚¬ í•¨ìˆ˜]
 * ì§€ì •ëœ ID ë‚´ë¶€ì˜ table ìš”ì†Œë¥¼ ì°¾ì•„ì„œ í´ë¦½ë³´ë“œì— ë³µì‚¬í•¨ (ì„œì‹ ìœ ì§€)
 */
const qCopy=id=>{
    const s=getSelection(), r=document.createRange(), e=$(id);
    r.selectNodeContents(e.querySelector('table')||e);
    s.removeAllRanges(); s.addRange(r); document.execCommand("copy"); s.removeAllRanges();
};

/**
 * [ê·¼ë¬´ ì£¼ê¸° íŒë³„ í•¨ìˆ˜ - í•µì‹¬ ë¡œì§]
 * ë‚ ì§œì™€ ìŠ¤ìœ™ ì²´í¬ ì—¬ë¶€ë¥¼ ë„£ìœ¼ë©´ í•´ë‹¹ ì‹œì ì˜ ê·¼ë¬´ ì¸ë±ìŠ¤(sic)ë¥¼ ë°˜í™˜
 * sic ê°’: 0:MOR, 1:MID, 2:SWI, 3:AFT, 4:BRK, 5:BRK (5ì¼ 6êµëŒ€)
 */
function getSic(m, d, sw){
    let ep=new Date(Y,AM-1,AD-1).setHours(0,0,0,0); // ê¸°ì¤€ì¼(2.17)
    let td=Math.round((new Date(Y,m-1,d).setHours(0,0,0,0)-ep)/864e5); // ê¸°ì¤€ì¼ë¡œë¶€í„° ê²½ê³¼ ì¼ìˆ˜
    let cd=((td%5)+5)%5; // 5ì¼ ì£¼ê¸° ì¤‘ ë©°ì¹ ì§¸ì¸ì§€ (0~4)
    // 0ì¼ì§¸ë©´ MOR(0), 1ì¼ì§¸ë©´ MID(1) ë˜ëŠ” SWI(2), ê·¸ ì™¸ì—” ë‚ ì§œ+1 (AFT:3, BRK:4,5)
    return cd==0?0:cd==1?(sw?2:1):cd+1;
}

/**
 * [ê·¼ë¬´ ì´ë™ í•¨ìˆ˜]
 * ì´ì „/ë‹¤ìŒ ë²„íŠ¼ í´ë¦­ ì‹œ ë‚ ì§œì™€ ìŠ¤ìœ™ ì²´í¬ë°•ìŠ¤ë¥¼ ìœ ê¸°ì ìœ¼ë¡œ ë³€ê²½í•¨
 */
function move(step, p){
    let m=$(p+'M'), d=$(p+'D'), sw=$(p+'SW'), s=getSic(+m.value,+d.value,sw.checked);
    if(step>0){ // [ë‹¤ìŒ]ìœ¼ë¡œ ì´ë™ ì‹œ ë¡œì§
        if(s==1)sw.checked=true; // MIDì—ì„œ ë‹¤ìŒì€ ê°™ì€ ë‚  SWI
        else{sw.checked=false; let n=new Date(Y,+m.value-1,+d.value+1); m.value=n.getMonth()+1; d.value=n.getDate();}
        if(p=='sol')$(p+'OF').value=+$(p+'OF').value+1; // ë³‘ì‚¬ëŠ” ì˜¤í”„ì…‹ë„ ê°™ì´ ì¦ê°€
    } else { // [ì´ì „]ìœ¼ë¡œ ì´ë™ ì‹œ ë¡œì§
        if(s==2)sw.checked=false; // SWIì—ì„œ ì´ì „ì€ ê°™ì€ ë‚  MID
        else{if(s==3)sw.checked=true; else sw.checked=false; let n=new Date(Y,+m.value-1,+d.value-1); m.value=n.getMonth()+1; d.value=n.getDate();}
        if(p=='sol')$(p+'OF').value=+$(p+'OF').value-1; // ë³‘ì‚¬ëŠ” ì˜¤í”„ì…‹ë„ ê°™ì´ ê°ì†Œ
    }
    window[p+'Run'](); // ì´ë™ í›„ ìë™ìœ¼ë¡œ ì¡°íšŒ ì‹¤í–‰
}

/* --- 1. ë¹„ìƒëŒ€ê¸°ì Parser ë¡œì§ (íŒ€ ìš°ì„ ìˆœìœ„ ìˆ˜ì •) --- */
const W_List="ëŒ€ìœ„,ëŒ€ìœ„(ì§„),ì¤‘ìœ„,ì¤‘ìœ„(ì§„),ì†Œìœ„,ì†Œìœ„(ì§„),ì¤€ìœ„,ì›ì‚¬,ì›ì‚¬(ì§„),ìƒì‚¬,ìƒì‚¬(ì§„),ì¤‘ì‚¬,ì¤‘ì‚¬(ì§„),í•˜ì‚¬,í•˜ì‚¬(ì§„)".split(',');
const getW=s=>{let i=W_List.indexOf(s.split(' ')[0]); return i<0?99:i;};

function parseRun(){
    let v=$('parseI').value.replace(/"/g,""); if(!v)return;
    let L1=[], L2=[], A=[];
    
    // ì¸í’‹ ë°ì´í„°ë¥¼ ì¤„ë‹¨ìœ„ -> íƒ­ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ì—¬ A ì–´ë ˆì´ì— 8ëª… ìˆœì°¨ ì €ì¥
    v.split('\n').map(L=>{
        let P=L.split('\t');
        const f=s=>s.split('/').map(x=>x.trim()).filter(x=>x);
        if(P[0]){ f(P[0]).map(x=>A.push({n:x,t:"1ì‹œê°„"})); }
        if(P[1]){ f(P[1]).map(x=>A.push({n:x,t:"30ë¶„"})); }
    });

    // ì¶œë ¥ 1ìš© (ì‰¼í‘œ ë‚˜ì—´ - ì›ë˜ ì¤„ë°”ê¿ˆ ê¸°ì¤€ ìœ ì§€)
    // ì¸í’‹ì˜ í˜•íƒœë¥¼ ë³´ê³  L1, L2ì— ì‰¼í‘œë¡œ í•©ì³ì„œ ë„£ì–´ì£¼ëŠ” ë¡œì§
    let rawLines = v.split('\n');
    rawLines.map(L => {
        let P=L.split('\t');
        if(P[0]) L1.push(P[0].split('/').map(x=>x.trim()).filter(x=>x).join(', '));
        if(P[1]) L2.push(P[1].split('/').map(x=>x.trim()).filter(x=>x).join(', '));
    });
    $('parseO1').innerHTML=`<table border='1'><tr><td>${L1.join('<br>')}</td>${L2.length?`<td>${L2.join('<br>')}</td>`:''}</tr></table>`;

    // ì¶œë ¥ 2ìš© (íŒ€ë³„ ì •ë ¬ - 1ì¸ë‹¹ 1ì¤„)
    // gí•¨ìˆ˜: ì¸ë±ìŠ¤ë¥¼ ë°›ì•„ì„œ í•´ë‹¹ ì¸ì›ë“¤ì„ ì„œì—´ìˆœ ì •ë ¬í•´ ë°˜í™˜
    let g=(...indices)=>indices.map(i=>A[i]).filter(x=>x).sort((a,b)=>getW(a.n)-getW(b.n));

    /**
     * íŒ€ ë°°ì¹˜ ë¡œì§ (ì‚¬ìš©ì ìš”ì²­ ë°˜ì˜)
     * ì¸ë±ìŠ¤ ê¸°ì¤€: 0(1), 1(2), 2(3), 3(4), 4(5), 5(6), 6(7), 7(8)
     * íŒ€ 1: 1, 2, 6 (0, 1, 5)
     * íŒ€ 2: 3, 7 (2, 6)
     * íŒ€ 3: 4, 8 (3, 7)
     * íŒ€ 4: 5 (4)
     */
    let F=[
        ...g(0, 1, 5), // íŒ€ 1
        ...g(2, 6),    // íŒ€ 2
        ...g(3, 7),    // íŒ€ 3
        ...g(4)        // íŒ€ 4
    ];

    $('parseO2').innerHTML=`<table border='1'>${F.map(x=>`<tr><td>${x.n}</td><td>${x.t}</td></tr>`).join('')}</table>`;
}

/* --- 2. ë³‘ì‚¬íœ´ê°€ Scraper ë¡œì§ --- */
// ë³‘ì‚¬ ëª…ë‹¨: ë°±í‹±(`)ì„ ì‚¬ìš©í•´ ì¤„ë°”ê¿ˆ ê·¸ëŒ€ë¡œ ì¸ì‹
const SOL_LIST=`
ë³‘ì¥ ì´ë¦„1
ë³‘ì¥ ì´ë¦„2
ë³‘ì¥ ì´ë¦„3
ë³‘ì¥ ì´ë¦„4
ë³‘ì¥ ì´ë¦„5
ë³‘ì¥ ì´ë¦„6
ìƒë³‘ ì´ë¦„7
ìƒë³‘ ì´ë¦„8
ìƒë³‘ ì´ë¦„9
ìƒë³‘ ì´ë¦„10
ìƒë³‘ ì´ë¦„11
ì¼ë³‘ ì´ë¦„12
ì¼ë³‘ ì´ë¦„13
ì¼ë³‘ ì´ë¦„14
ì´ë³‘ ì´ë¦„15
`.trim().split('\n');
$('solM').value=new Date().getMonth()+1; $('solD').value=new Date().getDate();

function solRun(){
    let m=+$('solM').value, d=+$('solD').value, of=+$('solOF').value, v=$('solI').value, ans=[], W=0;
    let ep=new Date(Y,AM-1,AD-1).setHours(0,0,0,0), target=new Date(Y,m-1,d).setHours(0,0,0,0);
    // í˜„ì¬ ì¡°íšŒì¼ì˜ ê·¼ë¬´ ì£¼ê¸° ìƒ ìœ„ì¹˜(s)ì™€ ê·¸ì— ë”°ë¥¸ ì—‘ì…€ ì—´ ì¸ë±ìŠ¤(sa) ê³„ì‚°
    let s=getSic(m,d,$('solSW').checked), sa=Math.floor(Math.round((target-ep)/864e5)/5)*6+s-of;
    $('solINF').innerText=`[${m}.${d}. ${["MOR","MID","SWI","AFT","BRK","BRK"][s]}]`;
    if(!v)return;
    // ì¸ë±ìŠ¤ë¥¼ ë‚ ì§œë¡œ ì—­ì‚°í•˜ëŠ” í•¨ìˆ˜
    let gD=a=>new Date(ep+(Math.floor(a/6)*5+[0,1,1,2,3,4][((a%6)+6)%6])*864e5), ls=v.split('\n').map(x=>x.split('\t').map(y=>y.trim()));
    
    SOL_LIST.forEach((sl,i)=>{
        let r=ls[i]; if(!r)return;
        for(let j=0;j<r.length;j++) if((r[j]=="íœ´"||VM[r[j]]) && gD(sa+j).getTime()==target){
            let st=j, ed=j, lv=r[j]; 
            // ê°™ì€ ì¢…ë¥˜ì˜ íœ´ê°€ê°€ ì•ë’¤ë¡œ ì–¼ë§ˆë‚˜ ì—°ì†ë˜ëŠ”ì§€ í™•ì¸ (ê¸°ê°„ ì‚°ì¶œ)
            while(st>0&&r[st-1]==lv)st--; while(ed<r.length-1&&r[ed+1]==lv)ed++;
            if(st==0||ed==r.length-1)W=1; // ë°ì´í„°ê°€ ì˜ë ¸ì„ ê°€ëŠ¥ì„± ì²´í¬
            ans.push(`${sl}<br><br>${lv=="íœ´"?"":`(${VM[lv]||lv})<br><br>`}${fmtDt(m,gD(sa+st).getDate(),gD(sa+ed).getDate())}`); break;
        }
    });
    $('solO').innerHTML=`<table id='solT' border='1'><tr><td>${ans.join("<br><br>")}</td></tr></table>`;
    $('solMSG').innerText=W?"âš ï¸ ì§¤ë¦¼!":""; qCopy('solO');
}

/* --- 3. ê°„ë¶€íœ´ê°€ Scraper ë¡œì§ --- */
$('offM').value=new Date().getMonth()+1; $('offD').value=new Date().getDate();
function offRun(){
    let m=+$('offM').value, d=+$('offD').value, v=$('offI').value, t=0, b=0;
    // ê°„ë¶€ìš© 12ì¹¸ (4ê°œ íŒ€ x 3ê°œ ì§ê¸‰êµ°) ì €ì¥ì†Œ ìƒì„±
    let R={1:{ì‚¬:[],ì¤€:[],ë¶€:[]},2:{ì‚¬:[],ì¤€:[],ë¶€:[]},3:{ì‚¬:[],ì¤€:[],ë¶€:[]},4:{ì‚¬:[],ì¤€:[],ë¶€:[]}};
    let s=getSic(m,d,$('offSW').checked); $('offINF').innerText=`[${m}.${d}. ${["MOR","MID","SWI","AFT","BRK","BRK"][s]}]`;
    if(!v)return;
    let ls=v.split('\n').map(x=>x.split('\t').map(y=>y.trim())), tCol=-1, lastH=null;
    
    ls.forEach(L=>{
        // 1. í—¤ë” í–‰(ë‚ ì§œ ì íŒ í–‰)ì—ì„œ ì¡°íšŒì¼ì´ ëª‡ ë²ˆì§¸ ì—´ì¸ì§€ ì°¾ìŒ
        if(L.some(c=>c==d.toString())){
            let idxs=L.map((c,i)=>c==d.toString()?i:-1).filter(i=>i!=-1);
            tCol=(idxs.length>1&&$('offSW').checked)?idxs[1]:idxs[0]; // MID/SWI êµ¬ë¶„
            lastH=L; if(!b){t++;b=1;} return;
        }
        // 2. ì¸ì› ë°ì´í„° í–‰ ì²˜ë¦¬
        if(L.length<2||(!L[0]&&!L[1])){b=0; return;}
        // ì§ê¸‰ íŒë³„: ì¤€ìœ„ -> ì‚¬(ì¥êµ) -> ë¶€(ë¶€ì‚¬ê´€) ìˆœ
        let r=L[0], n=L[1], k=r.includes("ì¤€ìœ„")?"ì¤€":r.includes("ìœ„")||r.includes("ë ¹")?"ì‚¬":r.includes("ì‚¬")||r.includes("ì›")?"ë¶€":"";
        if(!k||tCol==-1||!lastH)return;
        let lv=L[tCol]; if(lv=="íœ´"||VM[lv]){
            let st=tCol, ed=tCol; while(st>2&&L[st-1]==lv)st--; while(ed<L.length-1&&L[ed+1]==lv)ed++;
            R[t][k].push(`${r} ${n}<br><br>${lv=="íœ´"?"":`(${VM[lv]||lv})<br><br>`}${fmtDt(m,lastH[st]||d,lastH[ed]||d)}`);
        }
    });
    // ê²°ê³¼ í…Œì´ë¸” ë Œë”ë§
    let h="<table id='offT' border='1'><tr>";
    for(let i=1;i<5;i++) ["ì‚¬","ì¤€","ë¶€"].forEach(k=>h+=`<td valign='top'>${R[i][k].join("<br><br>")}</td>`);
    $('offO').innerHTML=h+"</tr></table>"; qCopy('offO');
}
</script>
</body>
</html>