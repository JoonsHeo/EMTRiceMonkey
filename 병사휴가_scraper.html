í˜„ì¬ ê¸°ì¤€ <input type="number" id="OF" value="5" style="width:40px">ì—´ ì „ë¶€í„° ë³µë¶™<br>
ì¡°íšŒì¼: <input id="M" size="2">ì›” <input id="D" size="2">ì¼
<button onclick="X()">ì¡°íšŒ ğŸš€</button> <span id="INF" style="color:#27ae60;font-weight:bold;"></span><br>
<textarea id="I" cols="60" rows="4" placeholder="ì´ë¦„/ë‚ ì§œ ë¹¼ê³  ë”± 'íœ´ê°€ ê·¸ë¦¬ë“œ'ë§Œ í†µì§¸ë¡œ ë³µë¶™"></textarea><br>
<button onclick="C(O, this)">ğŸ“‹ í‘œ ë³µì‚¬</button> <span id="MSG" style="color:red;font-weight:bold;margin-left:10px;"></span>
<div id="O" style="padding:5px; background:#eee; margin-top:5px;"></div>

<script>
// ğŸ‘‡ ë¯¸ë“œ ê¸°ì¤€ì¼ (ì›”, ì¼)
let AM = 2, AD = 17; 

// ğŸ‘‡ ë³‘ì‚¬ ëª…ë‹¨ (ë³µì‚¬í•  ì—‘ì…€ í–‰ ìˆœì„œì™€ ë˜‘ê°™ì´ ìœ„ì—ì„œë¶€í„° ì‘ì„±)
let SL = `
ë³‘ì¥ ì´ë¦„1
ë³‘ì¥ ì´ë¦„2
ë³‘ì¥ ì´ë¦„3
ë³‘ì¥ ì´ë¦„4
ë³‘ì¥ ì´ë¦„5
ë³‘ì¥ ì´ë¦„6
ìƒë³‘ ì´ë¦„7
ìƒë³‘ ì´ë¦„8
ìƒë³‘ ì´ë¦„9
ìƒë³‘ ì´ë¦„10
ìƒë³‘ ì´ë¦„11
ì¼ë³‘ ì´ë¦„12
ì¼ë³‘ ì´ë¦„13
ì¼ë³‘ ì´ë¦„14
ì´ë³‘ ì´ë¦„15
`.trim().split('\n');

// íŒì—… ì—†ì´ ë²„íŠ¼ ê¸€ìë§Œ 2ì´ˆê°„ 'âœ… ë³µì‚¬ì™„ë£Œ'ë¡œ ë°”ë€Œê²Œ ìˆ˜ì •
let C=(e,b)=>{let s=getSelection(), r=document.createRange(); r.selectNodeContents(e); s.removeAllRanges(); s.addRange(r); document.execCommand("copy"); s.removeAllRanges(); b.innerText="âœ… ë³µì‚¬ë¨!"; setTimeout(()=>b.innerText="ğŸ“‹ í‘œ ë³µì‚¬",2000);}

let t=new Date(), Y=t.getFullYear();
M.value=t.getMonth()+1; D.value=t.getDate();

function X(){
    let m=+M.value, d=+D.value, of=+OF.value, v=I.value, ans=[], W=0;
    
    let ep = new Date(Y, AM-1, AD-1).setHours(0,0,0,0);
    let td = Math.floor((new Date(Y, t.getMonth(), t.getDate()).setHours(0,0,0,0) - ep)/864e5);
    let cd = ((td%5)+5)%5, sic = cd==0?0 : cd==1?(t.getHours()<12?1:2) : cd+1;
    let ca = Math.floor(td/5)*6 + sic, sa = ca - of; 
    
    INF.innerText = `[${["MOR","MID","SWI","AFT","BRK","BRK"][sic]} ê¸°ì¤€]`;
    MSG.innerText = ""; // ì¼¤ ë•Œë§ˆë‹¤ ê²½ê³ ì°½ ì´ˆê¸°í™”
    if(!v) return;
    
    let gD = a => new Date(ep + (Math.floor(a/6)*5 + [0,1,1,2,3,4][((a%6)+6)%6])*864e5);
    let V = ["íœ´","í¬íœ´","ì—°ê°€","ê³µê°€","ìœ„ë¡œ","ì™¸ë°•","ë³´ìƒ"];
    
    // ì—‘ì…€ ì¹¸ ë°ì´í„° ë°°ì—´í™”
    let ls = v.split('\n').map(x=>x.split('\t').map(y=>y.trim()));
    
    // ëª…ë‹¨(SL)ì˜ ië²ˆì§¸ ì‚¬ëŒ = ì—‘ì…€(ls)ì˜ ië²ˆì§¸ ì¤„
    SL.forEach((sl, i) => {
        let r = ls[i]; 
        if(!r) return;
        let dl = r.length;
        
        for(let j=0; j<dl; j++){
            let lv = r[j];
            if(V.includes(lv)){
                let cd_date = gD(sa+j);
                if(cd_date.getMonth()+1 == m && cd_date.getDate() == d){
                    let st=j, ed=j;
                    while(st>0 && r[st-1]==lv) st--;
                    while(ed<dl-1 && r[ed+1]==lv) ed++;
                    
                    if(st==0 || ed==dl-1) W=1; // ê²½ê³  í”Œë˜ê·¸
                    
                    let d1 = gD(sa+st), d2 = gD(sa+ed);
                    let dt = d1.getTime()==d2.getTime() ? `(${d1.getMonth()+1}.${d1.getDate()}.)` : `(${d1.getMonth()+1}.${d1.getDate()}.~${d1.getMonth()==d2.getMonth()?"":d2.getMonth()+1+"."}${d2.getDate()}.)`;
                    ans.push(`${sl}<br><br>${lv=="íœ´"?"":`(${lv})<br><br>`}${dt}`);
                    break;
                }
            }
        }
    });
    
    O.innerHTML = `<table border='1'><tr><td valign='top'>${ans.join("<br><br><br>")}</td></tr></table>`;
    // íŒì—… ëŒ€ì‹  ë²„íŠ¼ ì˜†ì— ë¹¨ê°„ ê¸€ì”¨ë¡œ ê²½ê³  ì¶œë ¥
    if(W) MSG.innerText = "âš ï¸ ì§¤ë¦° ì¼ì • í™•ì¸!"; 
}
X();
</script>