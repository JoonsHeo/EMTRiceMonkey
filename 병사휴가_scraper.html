<h2 style="margin:5px 0;">ë³‘ì‚¬íœ´ê°€ Scraper</h2>
ë³µë¶™ê¸°ì¤€ <input type="number" id="OF" value="5" style="width:40px">ì—´ ì „ | 
<label><input type="checkbox" id="SW"> ì¡°íšŒì¼ì´ ìŠ¤ìœ™â˜‘ï¸</label><br>
ì¡°íšŒì¼: <input id="M" size="2">ì›” <input id="D" size="2">ì¼ 
<button onclick="P()">âª ì´ì „</button>
<button onclick="X()">ì¡°íšŒ+ë³µì‚¬ ğŸš€</button> 
<button onclick="N()">ë‹¤ìŒ â©</button><br>
<span id="INF" style="color:#27ae60;font-weight:bold;"></span>
<span id="MSG" style="color:red;font-weight:bold;margin-left:5px;"></span><br>
<textarea id="I" cols="60" rows="4" placeholder="ë”± 'íœ´ê°€ ê·¸ë¦¬ë“œ'ë§Œ ë³µë¶™"></textarea>
<div id="O" style="padding:5px; background:#eee; margin-top:5px;"></div>

<script>
let AM = 2, AD = 17; // ê¸°ì¤€ ë¯¸ë“œì¼: 2ì›” 17ì¼

// ğŸ‘‡ ë³‘ì‚¬ ëª…ë‹¨ (ì´ë¦„ ì‚¬ì´ì— ì‹¤ì œ ì¤„ë°”ê¿ˆì„ í•´ì„œ 15ëª…ì„ ì ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤)
let SL = `
ë³‘ì¥ ì´ë¦„1
ë³‘ì¥ ì´ë¦„2
ë³‘ì¥ ì´ë¦„3
ë³‘ì¥ ì´ë¦„4
ë³‘ì¥ ì´ë¦„5
ë³‘ì¥ ì´ë¦„6
ìƒë³‘ ì´ë¦„7
ìƒë³‘ ì´ë¦„8
ìƒë³‘ ì´ë¦„9
ìƒë³‘ ì´ë¦„10
ìƒë³‘ ì´ë¦„11
ì¼ë³‘ ì´ë¦„12
ì¼ë³‘ ì´ë¦„13
ì¼ë³‘ ì´ë¦„14
ì´ë³‘ ì´ë¦„15
`.trim().split('\n');

let VM = { "í¬ìƒ":"í¬ìƒíœ´ê°€", "ë³´ìƒ":"ë³´ìƒíœ´ê°€", "ìœ„ë¡œ":"ìœ„ë¡œíœ´ê°€", "í¬íœ´":"í¬ìƒíœ´ê°€", "ì—°ê°€":"ì—°ê°€", "ê³µê°€":"ê³µê°€", "ì™¸ë°•":"ì™¸ë°•" };
let Y = new Date().getFullYear(); M.value = new Date().getMonth()+1; D.value = new Date().getDate();

function G(m, d) {
    let ep=new Date(Y,AM-1,AD-1).setHours(0,0,0,0), td=Math.round((new Date(Y,m-1,d).setHours(0,0,0,0)-ep)/864e5);
    let cd=((td%5)+5)%5; return {td, cd, sic:cd==0?0:cd==1?(SW.checked?2:1):cd+1};
}
function N(){ 
    let {sic} = G(+M.value, +D.value);
    if(sic==1) SW.checked=true;
    else { SW.checked=false; let n=new Date(Y,+M.value-1,+D.value+1); M.value=n.getMonth()+1; D.value=n.getDate(); }
    OF.value=+OF.value+1; X();
}
function P(){ 
    let {sic} = G(+M.value, +D.value);
    if(sic==2) SW.checked=false;
    else { if(sic==3) SW.checked=true; else SW.checked=false; let n=new Date(Y,+M.value-1,+D.value-1); M.value=n.getMonth()+1; D.value=n.getDate(); }
    OF.value=+OF.value-1; X();
}
function X(){
    let m=+M.value, d=+D.value, of=+OF.value, v=I.value, ans=[], W=0;
    let ep = new Date(Y, AM-1, AD-1).setHours(0,0,0,0), target = new Date(Y, m-1, d).setHours(0,0,0,0);
    let {sic} = G(m, d), ca = Math.floor(Math.round((target-ep)/864e5)/5)*6 + sic, sa = ca - of; 
    INF.innerText = `[${m}.${d}. ${["MOR","MID","SWI","AFT","BRK","BRK"][sic]} ê¸°ì¤€]`;
    MSG.innerText = ""; if(!v) return;
    let gD = a => new Date(ep + (Math.floor(a/6)*5 + [0,1,1,2,3,4][((a%6)+6)%6])*864e5);
    let ls = v.split('\n').map(x=>x.split('\t').map(y=>y.trim()));
    SL.forEach((sl, i) => {
        let r = ls[i]; if(!r) return;
        for(let j=0; j<r.length; j++){
            let lv = r[j];
            if(lv=="íœ´" || VM[lv]){
                let cD = gD(sa+j);
                if(cD.getTime() == target){
                    let st=j, ed=j;
                    while(st>0 && r[st-1]==lv) st--; while(ed<r.length-1 && r[ed+1]==lv) ed++;
                    if(st==0 || ed==r.length-1) W=1;
                    let d1 = gD(sa+st), d2 = gD(sa+ed), vn = VM[lv] || lv;
                    let dt = d1.getTime()==d2.getTime() ? `(${d1.getMonth()+1}.${d1.getDate()}.)` : `(${d1.getMonth()+1}.${d1.getDate()}.~${d1.getMonth()==d2.getMonth()?"":d2.getMonth()+1+"."}${d2.getDate()}.)`;
                    ans.push(`${sl}<br><br>${lv=="íœ´"?"":`(${vn})<br><br>`}${dt}`); break;
                }
            }
        }
    });
    O.innerHTML = `<table id='T' border='1'><tr><td valign='top'>${ans.join("<br><br><br>")}</td></tr></table>`;
    if(W) MSG.innerText = "âš ï¸ ì§¤ë¦° ì¼ì •ì£¼ì˜!";
    let s=getSelection(), rg=document.createRange(); rg.selectNodeContents(T); s.removeAllRanges(); s.addRange(rg); document.execCommand("copy"); s.removeAllRanges();
}
</script>