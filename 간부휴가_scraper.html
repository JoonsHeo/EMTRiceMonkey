<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í†µì œëŒ€ ì¼ì¼ íœ´ê°€ì ìë™ ì¶”ì¶œ íˆ´ (ìµœì¢…ë³¸)</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; background-color: #f4f7f6; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
        .flex-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px; }
        h2 { color: #2c3e50; margin: 0; }
        .date-picker { font-size: 16px; padding: 8px; border: 2px solid #3498db; border-radius: 4px; font-weight: bold; color: #d35400; width: 60px; text-align: center; }
        textarea { width: 100%; height: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; box-sizing: border-box; font-family: 'Malgun Gothic'; }
        .main-btn { background-color: #27ae60; color: white; border: none; padding: 12px; font-size: 16px; border-radius: 4px; cursor: pointer; font-weight: bold; width: 100%; margin: 15px 0; }
        .main-btn:hover { background-color: #2ecc71; }
        .result-area { width: 100%; height: 280px; padding: 10px; border: 1px solid #3498db; background-color: #f4faff; box-sizing: border-box; resize: vertical; font-size: 14px; line-height: 1.6; }
    </style>
</head>
<body>

<div class="container">
    <div class="flex-header">
        <h2>ğŸŒ´ í†µì œëŒ€ ê°„ë¶€ ì¼ì¼ íœ´ê°€ì ì¶”ì¶œê¸°</h2>
        <div>
            <label><b>ì¡°íšŒí•  ë‚ ì§œ(ì¼): </b></label>
            <input type="number" id="targetDay" class="date-picker" min="1" max="31">
        </div>
    </div>
    
    <label><b>ğŸ“¥ ì—‘ì…€ ë°ì´í„° ì›ë³¸ ì „ì²´ ë³µë¶™ (1íŒ€~4íŒ€ ì­‰ ë“œë˜ê·¸í•´ì„œ ë¶™ì—¬ë„£ê¸°):</b></label>
    <textarea id="inputData" placeholder="1 2 3 4 5 6 7 8 ...&#10;ëŒ€ìœ„ ê¹€ê¹€ê¹€         íœ´&#10;..."></textarea>

    <button class="main-btn" onclick="processLeave()">ì˜¤ëŠ˜ íœ´ê°€ì ë½‘ê³  12ì¹¸ìœ¼ë¡œ ì •ë ¬ ğŸš€</button>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
        <label><b>ğŸ“‹ ì¶œë ¥ ê²°ê³¼ (1íŒ€ ì‚¬ê´€ ~ 4íŒ€ ë¶€ì‚¬ê´€, 12ì¤„):</b></label>
        <button onclick="copyResult()" style="padding: 5px 15px; cursor: pointer; background: #3498db; color: white; border: none; border-radius: 3px; font-weight: bold;">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
    </div>
    <textarea id="outputData" class="result-area" readonly placeholder="ê²°ê³¼ê°€ ì—¬ê¸°ì— ì„¸ë¡œ 12ì¤„ë¡œ ë‚˜ì˜µë‹ˆë‹¤. (í•œê¸€ í‘œ ì²« ì¹¸ ëˆ„ë¥´ê³  Ctrl+V í•˜ì„¸ìš”)"></textarea>
</div>

<script>
    // [ì„¤ì • 1] ì¶”ì í•  íœ´ê°€ ì¢…ë¥˜ (ì´ ëª©ë¡ì— ìˆëŠ” ê¸€ìë§Œ íœ´ê°€ë¡œ ì¸ì •í•˜ê³  ê°€ì ¸ì˜´)
    const validLeaveTypes = ["íœ´", "í¬íœ´", "ì—°ê°€", "ê³µê°€", "ì²­ì›", "ìœ„ë¡œ"];

    // [ì„¤ì • 2] ê³„ê¸‰ ë¶„ë¥˜ ì‚¬ì „ (ì´ ëª©ë¡ì— ì—†ëŠ” ë‹¨ì–´ë¡œ ì‹œì‘í•˜ëŠ” ì¤„ì€ ë¬´ì‹œí•¨)
    const rankTypeMap = {
        "ëŒ€ì¥": "ì‚¬ê´€", "ì¤‘ì¥": "ì‚¬ê´€", "ì†Œì¥": "ì‚¬ê´€", "ì¤€ì¥": "ì‚¬ê´€",
        "ëŒ€ë ¹": "ì‚¬ê´€", "ì¤‘ë ¹": "ì‚¬ê´€", "ì†Œë ¹": "ì‚¬ê´€",
        "ëŒ€ìœ„": "ì‚¬ê´€", "ì¤‘ìœ„": "ì‚¬ê´€", "ì†Œìœ„": "ì‚¬ê´€",
        "ì¤€ìœ„": "ì¤€ì‚¬ê´€",
        "ì›ì‚¬": "ë¶€ì‚¬ê´€", "ì›ì‚¬(ì§„)": "ë¶€ì‚¬ê´€", "ìƒì‚¬": "ë¶€ì‚¬ê´€", "ì¤‘ì‚¬": "ë¶€ì‚¬ê´€", "í•˜ì‚¬": "ë¶€ì‚¬ê´€"
    };

    // ì˜¤ëŠ˜ ë‚ ì§œ ê¸°ë³¸ ì„¸íŒ…
    document.getElementById("targetDay").value = new Date().getDate();

    function processLeave() {
        const rawText = document.getElementById("inputData").value;
        const targetDay = parseInt(document.getElementById("targetDay").value, 10);
        
        if (!rawText.trim()) { alert("ì—‘ì…€ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”."); return; }

        const results = {
            1: { "ì‚¬ê´€": [], "ì¤€ì‚¬ê´€": [], "ë¶€ì‚¬ê´€": [] },
            2: { "ì‚¬ê´€": [], "ì¤€ì‚¬ê´€": [], "ë¶€ì‚¬ê´€": [] },
            3: { "ì‚¬ê´€": [], "ì¤€ì‚¬ê´€": [], "ë¶€ì‚¬ê´€": [] },
            4: { "ì‚¬ê´€": [], "ì¤€ì‚¬ê´€": [], "ë¶€ì‚¬ê´€": [] }
        };

        const lines = rawText.split("\n");
        
        let currentTeam = 0;  // í˜„ì¬ ì¶”ì  ì¤‘ì¸ íŒ€ ë²ˆí˜¸ (1ë¶€í„° ì‹œì‘)
        let isPersonBlock = false; // í˜„ì¬ ì‚¬ëŒ ëª…ë‹¨ì„ ì½ê³  ìˆëŠ” ì¤‘ì¸ì§€ ì²´í¬

        for (let line of lines) {
            // ì—‘ì…€ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ëŠ” íƒ­(\t)ìœ¼ë¡œ ì—´ì´ ë‚˜ë‰¨
            let cells = line.split("\t").map(s => s.trim());
            
            if (cells.length < 2) continue;

            let rank = cells[0];
            let name = cells[1];
            let type = rankTypeMap[rank]; // ì‚¬ê´€, ì¤€ì‚¬ê´€, ë¶€ì‚¬ê´€ ì¤‘ í•˜ë‚˜

            // ê³„ê¸‰ ëª©ë¡ì— ì—†ëŠ” ë‹¨ì–´(ì˜ˆ: '1', '2', '3' ê°™ì€ ë‹¬ë ¥ ë‚ ì§œ)ê°€ ì²« ì¹¸ì— ìˆë‹¤ë©´
            if (!type) {
                isPersonBlock = false; // ì‚¬ëŒ ëª…ë‹¨ ë¸”ë¡ì´ ëë‚¨ì„ í‘œì‹œ
                continue;
            }

            // ì—¬ê¸°ê¹Œì§€ ì½”ë“œê°€ ë‚´ë ¤ì™”ë‹¤ë©´ ì •ìƒì ì¸ ì‚¬ëŒ ëª…ë‹¨(ê³„ê¸‰) ì¤„ì´ë¼ëŠ” ëœ»!
            
            // ë§Œì•½ ë°©ê¸ˆ ì „ê¹Œì§€ ì‚¬ëŒ ëª…ë‹¨ì´ ì•„ë‹ˆì—ˆëŠ”ë°, ê°‘ìê¸° ì‚¬ëŒì´ ë‚˜íƒ€ë‚¬ë‹¤ë©´?
            // => ìƒˆë¡œìš´ íŒ€ ë‹¬ë ¥ì´ ì‹œì‘ëœ ê²ƒ! íŒ€ ë²ˆí˜¸ë¥¼ +1 ì˜¬ë¦¼
            if (!isPersonBlock) {
                currentTeam++;
                isPersonBlock = true;
            }

            // ë§Œì•½ ì‹¤ìˆ˜ë¡œ 5íŒ€ ì´ìƒ ë°ì´í„°ê°€ ë³µì‚¬ë˜ì–´ë„ ì—ëŸ¬ ì•ˆ ë‚˜ê²Œ 4íŒ€ê¹Œì§€ë§Œ ì²˜ë¦¬
            if (currentTeam > 4) break;

            // í•´ë‹¹ ë‚ ì§œì˜ ì—‘ì…€ ì—´ ë²ˆí˜¸ ì°¾ê¸° (1ì—´=ì§ê¸‰, 2ì—´=ì´ë¦„, 3ì—´=1ì¼ -> nì¼ì€ ì¸ë±ìŠ¤ n+1)
            let dayIndex = targetDay + 1;

            if (cells.length > dayIndex) {
                let leaveVal = cells[dayIndex];
                
                // í•´ë‹¹ ì¹¸ì— ì íŒ ê¸€ìê°€ ì§€ì •ëœ íœ´ê°€ ì¢…ë¥˜(íœ´, í¬íœ´ ë“±)ë¼ë©´
                if (validLeaveTypes.includes(leaveVal)) {
                    // ì˜ˆ: "ëŒ€ìœ„ ê¹€ê¹€3(í¬íœ´)" í˜•íƒœë¡œ ë§Œë“¤ì–´ì„œ ë°°ì—´ì— ì¶”ê°€
                    results[currentTeam][type].push(`${rank} ${name}(${leaveVal})`);
                }
            }
        }

        // ê²°ê³¼ë¬¼ì„ 12ì¤„ë¡œ ì˜ˆì˜ê²Œ ì¡°ë¦½
        let outputLines = [];
        for (let t = 1; t <= 4; t++) {
            outputLines.push(results[t]["ì‚¬ê´€"].join(", "));
            outputLines.push(results[t]["ì¤€ì‚¬ê´€"].join(", "));
            outputLines.push(results[t]["ë¶€ì‚¬ê´€"].join(", "));
        }

        document.getElementById("outputData").value = outputLines.join("\n");
    }

    // ë³µì‚¬ ë²„íŠ¼ ê¸°ëŠ¥
    function copyResult() {
        const copyText = document.getElementById("outputData");
        copyText.select();
        document.execCommand("copy");
        window.getSelection().removeAllRanges();
        alert("12ì¤„ í¼ ë³µì‚¬ ì™„ë£Œ! í•œê¸€/ì—‘ì…€ í‘œì˜ ì²« ì¹¸ì„ ëˆ„ë¥´ê³  Ctrl+V í•˜ì„¸ìš”.");
    }
</script>

</body>
</html>